load("untreated-differential_binding.RData")
knitr::opts_chunk$set(echo = TRUE)
prom_genes_ls2_vs_ls3_smad2enriched %>%
rmarkdown::paged_table()
library(tidyverse)
library(GenomicRanges)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(ChIPseeker)
library(clusterProfiler)
prom_genes_ls2_vs_ls3_smad2enriched %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ls3_smad3enriched %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ls3_bothenriched %>%
rmarkdown::paged_table()
intersect(prom_genes_ls2_vs_ls3_smad2enriched$GENENAME, prom_genes_ls2_vs_ls3_smad3enriched$GENENAME) %>% # finding common peaks between LAP-Smad2 and LAP-Smad3
tibble::enframe(name = "No.", value = "Promoter-proximal peak annotations") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
intersect(prom_genes_ls2_vs_ls3_smad2enriched$GENENAME, prom_genes_ls2_vs_ls3_bothenriched$GENENAME) %>%
tibble::enframe(name = "No.", value = "Promoter-proximal peak annotations") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
intersect(prom_genes_ls2_vs_ls3_smad3enriched$GENENAME, prom_genes_ls2_vs_ls3_bothenriched$GENENAME) %>%
tibble::enframe(name = "No.", value = "Promoter-proximal peak annotations") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
dplyr::union(intersect(prom_genes_ls2_vs_ls3_smad2enriched$GENENAME, prom_genes_ls2_vs_ls3_bothenriched$GENENAME),
intersect(prom_genes_ls2_vs_ls3_smad3enriched$GENENAME,prom_genes_ls2_vs_ls3_bothenriched$GENENAME)) %>%
dplyr::union(., intersect(prom_genes_ls2_vs_ls3_smad2enriched$GENENAME, prom_genes_ls2_vs_ls3_smad3enriched$GENENAME)) %>%
tibble::enframe(name = "No.", value = "'Ambiguous' genes") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ls3_smad2enriched %>% filter(!geneId %in% ambi_ls2_vs_ls3)
ego_prom_genes_ls2_vs_ls3_smad2enriched@result %>%
as_tibble() %>%
arrange(p.adjust, desc(Count) , desc(GeneRatio))  %>%
filter(p.adjust < 0.05) %>%
dplyr::select(Description, p.adjust, GeneRatio, BgRatio, geneID) %>%
rmarkdown::paged_table()
ego_prom_genes_ls2_vs_ls3_smad2enriched@result %>%
as_tibble()
ego_prom_genes_ls2_vs_ls3_smad2enriched@result %>%
as_tibble() %>%
arrange(p.adjust, desc(Count) , desc(GeneRatio))  %>%
# filter(p.adjust < 0.05) %>%
dplyr::select(Description, p.adjust, GeneRatio, BgRatio, geneID) %>%
rmarkdown::paged_table()
ego_prom_genes_ls2_vs_ls3_smad2enriched@result %>%
as_tibble() %>%
arrange(p.adjust, desc(Count) , desc(GeneRatio))  %>%
filter(p.adjust < 0.05) %>%
dplyr::select(Description, p.adjust, GeneRatio, BgRatio, geneID) %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ls3_smad3enriched %>% filter(!geneId %in% ambi_ls2_vs_ls3)
ego_prom_genes_ls2_vs_ls3_smad3enriched@result %>%
as_tibble() %>%
arrange(p.adjust, desc(Count) , desc(GeneRatio))  %>%
filter(p.adjust < 0.05) %>%
dplyr::select(Description, p.adjust, GeneRatio, BgRatio, geneID) %>%
rmarkdown::paged_table()
bed_ls2_vs_ns3_smad2enriched <- read_tsv("./treated-diffpeak_results/diff_lap-smad2_vs_native-smad3_c3.0_cond1.bed", skip = 1, col_names = c("chrom", "start", "end", "name", "log10_likelihood_ratio"))
read_tsv("./differential_binding/untreated/untreated-diffpeak_results/untreated-diff_lap-smad2_vs_native-smad3_c3.0_cond1.bed", skip = 1, col_names = c("chrom", "start", "end", "name", "log10_likelihood_ratio"))
read_tsv("./untreated-diffpeak_results/untreated-diff_lap-smad2_vs_native-smad3_c3.0_cond1.bed", skip = 1, col_names = c("chrom", "start", "end", "name", "log10_likelihood_ratio"))
read_tsv("./untreated-diffpeak_results/untreated-diff_lap-smad2_vs_native-smad3_c3.0_cond1.bed", skip = 1, col_names = c("chrom", "start", "end", "name", "log10_likelihood_ratio"))
ranges(ls2_vs_ns3_smad2enriched)
read_tsv("./untreated-diffpeak_results/untreated-diff_lap-smad2_vs_native-smad3_c3.0_common.bed", skip = 1, col_names = c("chrom", "start", "end", "name", "log10_likelihood_ratio"))
prom_genes_ls2_vs_ns3_smad2enriched %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ns3_smad3enriched %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ns3_bothenriched %>%
rmarkdown::paged_table()
intersect(prom_genes_ls2_vs_ns3_smad2enriched$GENENAME, prom_genes_ls2_vs_ns3_smad3enriched$GENENAME) %>% # finding common peaks between LAP-Smad2 and LAP-Smad3
tibble::enframe(name = "No.", value = "Promoter-proximal peak annotations") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
intersect(prom_genes_ls2_vs_ns3_smad2enriched$GENENAME, prom_genes_ls2_vs_ns3_bothenriched$GENENAME) %>% # finding common peaks between LAP-Smad2 and LAP-Smad3
tibble::enframe(name = "No.", value = "Promoter-proximal peak annotations") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
intersect(prom_genes_ls2_vs_ns3_smad3enriched$GENENAME, prom_genes_ls2_vs_ns3_bothenriched$GENENAME) %>% # finding common peaks between LAP-Smad2 and LAP-Smad3
tibble::enframe(name = "No.", value = "Promoter-proximal peak annotations") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
dplyr::union(intersect(prom_genes_ls2_vs_ns3_smad2enriched$GENENAME, prom_genes_ls2_vs_ns3_bothenriched$GENENAME),
intersect(prom_genes_ls2_vs_ns3_smad3enriched$GENENAME,prom_genes_ls2_vs_ns3_bothenriched$GENENAME)) %>%
dplyr::union(., intersect(prom_genes_ls2_vs_ns3_smad2enriched$GENENAME, prom_genes_ls2_vs_ns3_smad3enriched$GENENAME)) %>%
tibble::enframe(name = "No.", value = "'Ambiguous' genes") %>%
tidyr::drop_na() %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ns3_smad2enriched %>% filter(!geneId %in% ambi_ls2_vs_ns3)
ego_prom_genes_ls2_vs_ns3_smad2enriched@result %>%
as_tibble() %>%
arrange(p.adjust, desc(Count) , desc(GeneRatio))  %>%
filter(p.adjust < 0.05) %>%
dplyr::select(Description, p.adjust, GeneRatio, BgRatio, geneID) %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ns3_smad3enriched %>% filter(!geneId %in% ambi_ls2_vs_ns3)
ego_prom_genes_ls2_vs_ns3_smad3enriched@result %>%
as_tibble() %>%
arrange(p.adjust, desc(Count) , desc(GeneRatio))  %>%
filter(p.adjust < 0.05) %>%
dplyr::select(Description, p.adjust, GeneRatio, BgRatio, geneID) %>%
rmarkdown::paged_table()
prom_genes_ls2_vs_ns3_smad2enriched
prom_genes_ls2_vs_ns3_smad2enriched %>% filter(!geneId %in% ambi_ls2_vs_ns3)
